(function(e){function t(t){for(var i,a,o=t[0],c=t[1],l=t[2],d=0,v=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&v.push(s[a][0]),s[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);u&&u(t);while(v.length)v.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},s={app:0},r=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},2395:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("tree"),n("div",{staticClass:"start-taste-left"},[n("textarea",{staticClass:"ipt",attrs:{placeholder:"请输入评测文本"},domProps:{value:e.question}})]),e._v(" "+e._s(e.serverId)+" "),n("div",{class:["time-box",e.isTouch?"active":""]},[e._m(0),e._m(1)]),n("div",{class:["btn",e.isTouch?"touch":"start"],on:{touchstart:function(t){return t.preventDefault(),e.begin(t)},touchend:function(t){return t.preventDefault(),e.end(t)}}},[e._v(e._s(e.isTouch?"松开停止录音":"按住录音"))]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.resultShow,expression:"resultShow"}],staticClass:"rule-bg"},[n("div",{staticClass:"rule"},[n("div",{staticClass:"rule-info"},[n("p",{staticClass:"info-title"},[e._v("挑战结果")]),n("p",[e._v("准确度分："),n("span",{staticClass:"accuracy_score"},[e._v(e._s(e.accuracy_score))])]),n("p",[e._v("整体印象分："),n("span",{staticClass:"emotion_score"},[e._v(e._s(e.emotion_score))])]),n("p",[e._v("流畅度分："),n("span",{staticClass:"fluency_score"},[e._v(e._s(e.fluency_score))])]),n("p",[e._v("完整度分："),n("span",{staticClass:"integrity_score"},[e._v(e._s(e.integrity_score))])]),n("p",[e._v("声韵分："),n("span",{staticClass:"phone_score"},[e._v(e._s(e.phone_score))])]),n("p",[e._v("调型分："),n("span",{staticClass:"tone_score"},[e._v(e._s(e.tone_score))])]),n("p",[e._v("总分："),n("span",{staticClass:"total_score"},[e._v(e._s(e.total_score))])]),n("div",{staticClass:"right"},[n("p",{staticClass:"info-title"},[e._v("发音准确率")]),n("p",{staticClass:"result"},[e._v(e._s(e.resultStr))])])]),n("figure",{staticClass:"rule-close",on:{click:function(t){e.resultShow=!1}}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/close.png",alt:""}})])])])],1)},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"start-taste-line"},[n("hr",{staticClass:"hr hr1"}),n("hr",{staticClass:"hr hr2"}),n("hr",{staticClass:"hr hr3"}),n("hr",{staticClass:"hr hr4"}),n("hr",{staticClass:"hr hr5"}),n("hr",{staticClass:"hr hr6"}),n("hr",{staticClass:"hr hr7"}),n("hr",{staticClass:"hr hr8"}),n("hr",{staticClass:"hr hr9"}),n("hr",{staticClass:"hr hr10"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"total-time"},[n("span",{staticClass:"used-time"},[e._v("00: 00")]),e._v(" / 01: 00")])}],a=(n("4160"),n("45fc"),n("159b"),n("96cf"),n("1da1"));n("ac1f"),n("466d");function o(){var e=document.cookie,t="";if(e){var n=e.match(/userid=([^;$]+)/);n&&n[1]&&(t=n[1])}return t}var c=window.sessionStorage;function l(e,t){var n=0;try{c.setItem(e,JSON.stringify(t)),n=1}catch(i){console.error("客户端数据缓存错误")}return n}function u(e){var t=null;try{t=c.getItem(e),t=JSON.parse(t)}catch(n){console.error("获取客户端数据缓存错误")}return t}n("1276"),n("d3b7");var d=n("ade3"),v=n("bc3a"),p=n.n(v),h=(n("99af"),n("d4ec")),f=n("bee2"),m=function(){function e(){Object(h["a"])(this,e),this.ele=document.createElement("aside"),this.ele.classList.add("toast"),this.content=document.createElement("div"),this.content.classList.add("message-wrapper"),this.ele.appendChild(this.content),document.body.appendChild(this.ele),this.bind()}return Object(f["a"])(e,[{key:"confirm",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,i,s,r,a,o,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.content,i=void 0===n?"":n,s=t.ok,r=void 0===s?function(){}:s,a=t.cancel,o=void 0===a?function(){}:a,c=t.notice,l=void 0!==c&&c,this.ele.classList.add("visible"),this.content.innerHTML="<p>".concat(i,'</p><footer class="confirm-footer border-top">').concat(l?"":'<div data-type="close">取消</div>','<div data-type="ok" class="ok">确定<div></footer>'),this.ok=r,this.cancel=o;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"bind",value:function(){var e=this;this.content.addEventListener("click",(function(t){var n=t.target,i=void 0===n?{}:n;"ok"===i.dataset["type"]&&e.ok(),"close"===i.dataset["type"]&&(e.cancel(),e.hide())}))}},{key:"alert",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.ele.className="toast alert";var i=setTimeout((function(){e.ele.classList.add("visible"),clearTimeout(i)}),50);this.content.innerHTML="<p>".concat(t,"</p>");var s=setTimeout((function(){e.feadOut(),clearTimeout(s)}),n)}},{key:"feadOut",value:function(){var e=this;this.ele.classList.remove("visible");var t=setTimeout((function(){e.ele.className="toast",clearTimeout(t)}),200)}},{key:"hide",value:function(){this.ele.classList.remove("visible")}},{key:"loadingShow",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"正在加载...",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;this.ele.classList.add("visible"),this.ele.classList.add("load"),this.content.innerHTML="<p>".concat(t,"</p>");var i=setTimeout((function(){e.feadOut(),clearTimeout(i)}),n)}},{key:"loadingHide",value:function(){this.feadOut()}}]),e}(),g=new m,_=function(e){var t=e.url,n=e.data,i=void 0===n?{}:n,s=e.method,r=void 0===s?"GET":s,a="get"===r.toLocaleLowerCase()?"params":"data";return new Promise((function(e,n){p()(Object(d["a"])({method:r,url:t},a,i)).then((function(t){alert(JSON.stringify(t.data)),0===t.data.status||"ok"===t.data.message?e(t.data):(g.alert("请求失败"),n(t.data))})).catch((function(e){console.log(e)}))}))},w=_,b=!1,y=b?"/api":"https://miniapp.ionantha.tech",C=function(){return w({url:"".concat(y,"/api/getSignature"),data:{url:location.href.split("#")[0]},method:"POST"})},x=function(e){return w({url:"".concat(y,"/file/file_upload"),data:e})},S=(n("a4d3"),n("e01a"),n("9911"),function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(h["a"])(this,e);var i=n.sharpCallback,s=void 0===i?function(){}:i,r=n.jsApiList,o=void 0===r?["onMenuShareTimeline","updateTimelineShareData","updateAppMessageShareData","onMenuShareAppMessage","startRecord","stopRecord","playVoice","stopVoice","onVoicePlayEnd","uploadVoice"]:r,c=n.hideMenuItems,l=void 0===c?[]:c;this.sharpCallback=s,this.hideMenuItems=l;var u=navigator.userAgent.toLowerCase();if(u.match(/MicroMessenger/i)){var d=document.createElement("script");d.src="https://res2.wx.qq.com/open/js/jweixin-1.4.0.js",document.body.appendChild(d),d.onload=Object(a["a"])(regeneratorRuntime.mark((function e(){var n,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=window.wx,e.next=3,C();case 3:i=e.sent,i&&0===i.status&&(s=Object.assign(i.data,{debug:!1,jsApiList:o}),n.config(s),t.ready());case 5:case"end":return e.stop()}}),e)})))}}return Object(f["a"])(e,[{key:"ready",value:function(e){var t=this,n=window.wx,i=window.seo||{},s=i.title,r=void 0===s?document.title:s,a=i.link,o=void 0===a?window.location.href:a,c=i.description,l=void 0===c?"语音评测demo":c,u=i.imgUrl,d=void 0===u?"":u,v={title:r,link:o,desc:l,imgUrl:d};e&&Object.assign(v,e),v.success=function(){t.sharpCallback()},n&&n.ready((function(){/iPhone|iPad|iPod/i.test(navigator.userAgent)?(n.updateTimelineShareData(v),n.updateAppMessageShareData(v)):(n.onMenuShareTimeline(v),n.onMenuShareAppMessage(v)),t.hideMenuItems.length&&n.hideMenuItems({menuList:t.hideMenuItems})}))}}]),e}()),O=S,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home-tree"},[e._m(0),e._m(1),n("div",{staticClass:"bg-flower"},[n("figure",{class:{"bg-f1":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-1.png",alt:""}})]),n("figure",{class:{"bg-f2":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-2.png",alt:""}})]),n("figure",{class:{"bg-f3":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-3.png",alt:""}})]),n("figure",{class:{"bg-f4":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-4.png",alt:""}})]),n("figure",{class:{"bg-f5":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-5.png",alt:""}})]),n("figure",{class:{"bg-f6":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-2.png",alt:""}})]),n("figure",{class:{"bg-f7":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-1.png",alt:""}})]),n("figure",{class:{"bg-f8":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-3.png",alt:""}})]),n("figure",{class:{"bg-f9":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-5.png",alt:""}})]),n("figure",{class:{"bg-f10":!0,active:e.isActive}},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/1-4.png",alt:""}})])])])},k=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("figure",{staticClass:"left-tree"},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/left.png",alt:""}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("figure",{staticClass:"right-tree"},[n("img",{attrs:{src:"https://static.vr0101.com/images/topic/feihualing/home/bg/tree/right.png",alt:""}})])}],j={data:function(){return{isActive:!0}}},A=j,M=(n("d385"),n("2877")),E=Object(M["a"])(A,T,k,!1,null,null,null),L=E.exports,R={name:"App",components:{tree:L},data:function(){return{serverId:"",isTouch:!1,localId:"",start:"",question:"秦时明月汉时关，万里长征人未还。但使龙城飞将在，不教胡马度阴山。",accuracy_score:0,emotion_score:0,fluency_score:0,integrity_score:0,phone_score:0,tone_score:0,total_score:0,resultStr:"",resultShow:!1}},created:function(){this.getUid=o(),this.Sharp=new O},mounted:function(){this.panduan()},methods:{panduan:function(){var e=u("allowRecord");e||window.wx&&window.wx.startRecord({success:function(){window.wx&&window.wx.stopRecord({success:function(e){l("allowRecord","true")}})},cancel:function(){this.panduan()}})},begin:function(){this.start=(new Date).getTime();var e=setTimeout((function(){window.wx&&window.wx.startRecord({success:function(){this.isTouch=!0,clearTimeout(e)},cancel:function(){alert("拒绝授权")}})}),300)},end:function(){var e=this,t=(new Date).getTime();t-this.start<300||(this.isTouch=!1,window.wx.stopRecord({success:function(t){var n=t.localId;e.uploadVoice(n)},fail:function(){alert("录音失败")}}))},onVoiceRecordEnd:function(){var e=this;window.wx.onVoiceRecordEnd({complete:function(t){var n=t.localId;e.uploadVoice(n),e.status="录音"}})},uploadVoice:function(e){var t=this;g.loadingShow("正在上传..."),window.wx.uploadVoice({localId:e,isShowProgressTips:1,success:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(n){var i,s,r,a,o,c,l,u,d,v,p,h,f,m,_,w,b,y,C,S,O,T,k,j,A,M,E,L,R,I,P,V,D,$,N,q,J,H,U,G,z;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return g.loadingShow("正在解析..."),i=n.serverId,t.serverId=i,e.next=5,x({media_id:i,text:t.question});case 5:s=e.sent,"error"===s.data?g.alert("解析失败"):(g.toast("解析成功"),t.accuracy_score=null===s||void 0===s||null===(r=s.xml_result)||void 0===r||null===(a=r.read_sentence)||void 0===a||null===(o=a.rec_paper)||void 0===o||null===(c=o.read_sentence)||void 0===c?void 0:c.accuracy_score,t.emotion_score=null===s||void 0===s||null===(l=s.xml_result)||void 0===l||null===(u=l.read_sentence)||void 0===u||null===(d=u.rec_paper)||void 0===d||null===(v=d.read_sentence)||void 0===v?void 0:v.emotion_score,t.fluency_score=null===s||void 0===s||null===(p=s.xml_result)||void 0===p||null===(h=p.read_sentence)||void 0===h||null===(f=h.rec_paper)||void 0===f||null===(m=f.read_sentence)||void 0===m?void 0:m.fluency_score,t.integrity_score=null===s||void 0===s||null===(_=s.xml_result)||void 0===_||null===(w=_.read_sentence)||void 0===w||null===(b=w.rec_paper)||void 0===b||null===(y=b.read_sentence)||void 0===y?void 0:y.integrity_score,t.phone_score=null===s||void 0===s||null===(C=s.xml_result)||void 0===C||null===(S=C.read_sentence)||void 0===S||null===(O=S.rec_paper)||void 0===O||null===(T=O.read_sentence)||void 0===T?void 0:T.phone_score,t.tone_score=null===s||void 0===s||null===(k=s.xml_result)||void 0===k||null===(j=k.read_sentence)||void 0===j||null===(A=j.rec_paper)||void 0===A||null===(M=A.read_sentence)||void 0===M?void 0:M.tone_score,t.total_score=null===s||void 0===s||null===(E=s.xml_result)||void 0===E||null===(L=E.read_sentence)||void 0===L||null===(R=L.rec_paper)||void 0===R||null===(I=R.read_sentence)||void 0===I?void 0:I.total_score,G=(null===s||void 0===s||null===(P=s.xml_result)||void 0===P||null===(V=P.read_sentence)||void 0===V||null===(D=V.rec_paper)||void 0===D||null===($=D.read_sentence)||void 0===$||null===(N=$.sentence)||void 0===N?void 0:N.word)||(null===s||void 0===s||null===(q=s.xml_result)||void 0===q||null===(J=q.read_sentence)||void 0===J||null===(H=J.rec_paper)||void 0===H||null===(U=H.read_sentence)||void 0===U?void 0:U.sentence)||[],z="",G.forEach((function(e){if(null===e||void 0===e?void 0:e.word)e.word.forEach((function(e){var t,n=!1;(null===(t=e.syll)||void 0===t?void 0:t.phone)?n=e.syll.phone.some((function(e){return 0!=(null===e||void 0===e?void 0:e.perr_msg)})):e.syll.forEach((function(e){Array.isArray(null===e||void 0===e?void 0:e.phone)&&(n=e.phone.some((function(e){return 0!=(null===e||void 0===e?void 0:e.perr_msg)})))})),z+=n?'<span class="err">'.concat(e.content,"</span>"):e.content}));else if(null===e||void 0===e?void 0:e.syll){var t,n=!1;(null===(t=e.syll)||void 0===t?void 0:t.phone)?n=e.syll.phone.some((function(e){return 0!=(null===e||void 0===e?void 0:e.perr_msg)})):e.syll.forEach((function(e){Array.isArray(null===e||void 0===e?void 0:e.phone)&&(n=e.phone.some((function(e){return 0!=(null===e||void 0===e?void 0:e.perr_msg)})))})),z+=n?'<span class="err">'.concat(e.content,"</span>"):e.content}})),t.resultStr=z,t.resultShow=!0);case 7:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}(),error:function(){alert("上传失败")}})}}},I=R,P=(n("7c55"),Object(M["a"])(I,s,r,!1,null,null,null)),V=P.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(V)}}).$mount("#app")},"7c55":function(e,t,n){"use strict";var i=n("2395"),s=n.n(i);s.a},d385:function(e,t,n){"use strict";var i=n("edc3"),s=n.n(i);s.a},edc3:function(e,t,n){}});